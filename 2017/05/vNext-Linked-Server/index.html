<!DOCTYPE html><html lang="default"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"><meta name="author" content="ori donner"><meta name="google-site-verification" content="_1jVKCHfaTkKqBgpQP8PUJeLokwW_vYYemWqha7T9BE"><link rel="icon" href="/sqldevops.ico"><title>SQL DevOps</title><meta name="description"><link rel="alternate" type="application/rss+xml" title="SQL DevOps" href="/atom.xml"><link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="stylesheet" href="/css/bootstrap.min.css"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/css/highlight.css"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800">
</head><body><nav class="navbar navbar-default navbar-fixed-top navbar-custom"><div class="container-fluid"><div class="navbar-header"><button type="button" data-toggle="collapse" data-target="#main-navbar" class="navbar-toggle"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="/" class="navbar-brand">SQL DevOps</a></div><div id="main-navbar" class="collapse navbar-collapse"><ul class="nav navbar-nav navbar-right"><li><a href="/archives">Archive</a></li><li><a href="https://github.com/">Github</a></li></ul></div><div class="avatar-container"><div class="avatar-img-border"><a href="/"><img src="/sqldevops.ico" class="avatar-img"></a></div></div></div></nav><header class="header-section"><div class="intro-header no-img"><div class="container"><div class="row"><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class="post-heading"><h1>Linked Server on SQL Server vNext</h1><p class="post-meta">Posted on May 15 2017 · <a href="/tags/Linux/" class="tag post-meta">Linux</a> · <a href="/tags/vNnext/" class="tag post-meta">vNnext</a> · <a href="/tags/Linked-Server/" class="tag post-meta">Linked Server</a></p></div></div></div></div></div></header><div class="container"><div class="row"><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><article role="main" class="blog-post"><p>If you have started Microsoft’s vNext SQL Server on Linux or Docker container and tried to set up a linked server, using SSMS GUI, you probably got this error message: <br><br><br><img src="/images/LinkedServerError.PNG" class="col-md-7"></p>
<p><br><br><br><br><br>The reason is that Microsoft doesn’t support distributed queries on SQL Server vNext (yet), as published on Microsoft’s <a href="https://docs.microsoft.com/en-us/sql/linux/sql-server-linux-release-notes" target="_blank" rel="external">official site</a>:<br><br><br><img src="/images/LinkedServerUnsupported.PNG" alt=""></p>
<p>Linked server is an essential tool in SQL Server; The fact that distributed query feature is not yet supported is quite puzzling, given that <a href="https://www.microsoft.com/en-us/download/details.aspx?id=28160" target="_blank" rel="external">SQL Server ODBC Driver for Linux</a> is available since 2012.</p>
<p>But, if you are running SQL Server vNext on your dev-test Windows VirtualBox, linked server is available for you. And here you have another good reason for <a href="http://sqldevops.tech/2017/04/SQL-Server-vNext-Vagrant-Box/">starting SQL Server vNext on Windows VirtualBox</a>. </p>
<h2 id="Linked-Server-on-Windows-VirtualBox"><a href="#Linked-Server-on-Windows-VirtualBox" class="headerlink" title="Linked Server on Windows VirtualBox"></a>Linked Server on Windows VirtualBox</h2><p>This suggested solution will only work for SQL Server vNext running on Windows VirtualBox, trying to execute it on Docker container or Linux, will output the same error as mentioned above:</p>
<p><strong>1</strong>. Follow my <a href="http://sqldevops.tech/2017/04/SQL-Server-vNext-Vagrant-Box/">last post</a> about running SQL Server on Windows VirtualBox, download the <a href="https://atlas.hashicorp.com/sqldevops/boxes/sql-server-vnext/versions/1.01" target="_blank" rel="external">Vagrant box</a> (I have just updated vNext CTP 2.0), spin up the server and finally connect to it with SSMS.</p>
<p><strong>2</strong>. Use <a href="https://docs.microsoft.com/en-us/sql/relational-databases/system-stored-procedures/distributed-queries-stored-procedures-transact-sql" target="_blank" rel="external">distributed queries stored procedures</a> to create linked server :</p>
<p><code>EXEC master.dbo.sp_addlinkedserver</code><br><code>@server = N&#39;linked-server-name&#39;,</code><br><code>@srvproduct=N&#39;&#39;,</code><br><code>@provider=N&#39;SQLNCLI&#39;,</code><br><code>@datasrc=N&#39;network-name-of-sql-server or servername\instancename&#39;</code><br><code>GO</code> </p>
<p><strong>3</strong>. Create SQL Server login on your source SQL Server, for the remote login stored procedure (@rmtuser,@rmtpassword) :</p>
<p><code>EXEC master.dbo.sp_addlinkedsrvlogin</code><br><code>@rmtsrvname=N&#39;linked-server-name&#39;,</code><br><code>@useself=N&#39;False&#39;,</code><br><code>@locallogin=NULL,</code><br><code>@rmtuser=N&#39;sql-server-user-name&#39;,</code><br><code>@rmtpassword=&#39;sql-server-user-password&#39;</code><br><code>GO</code></p>
<p><strong>4</strong>. Your linked server is up and running.</p>
</article><ul class="pager blog-pager"></ul><div class="disqus-comments"><div class="comments"><div id="disqus_thread"></div></div></div><script>var url_parts = window.location.href.split("?");
var disqus_url = url_parts[0];
(function () {
    console.log("enter disqus");
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = "//https-sqldevops-github-io.disqus.com/embed.js";
    (document.head || d.body ).appendChild(dsq);
})();</script></div></div></div><footer><div class="container beautiful-jekyll-footer"><div class="row"><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center footer-links"><li><a href="https://github.com/sqldevops" title="GitHub"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-stack-1x fa-inverse fa-github"></i></span></a></li><li><a href="/atom.xml" title="RSS"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-stack-1x fa-inverse fa-rss"></i></span></a></li><li><a href="mailto:sqldevops@gmail.com" title="Email me"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-stack-1x fa-inverse fa-envelope"></i></span></a></li><li><a href="https://il.linkedin.com/in/oridonner" title="LinkedIn"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-stack-1x fa-inverse fa-linkedin"></i></span></a></li></ul><p class="copyright text-muted">© ori donner • 2017 • <a href="mailto:undefined"></a>
</p><p class="theme-by text-muted">Hosted by
<a href="https://pages.github.com/">GitHub Pages</a>
Powered by 
<a href="https://hexo.io/">Hexo</a></p></div></div></div></footer><script src="/js/jquery-1.11.2.min.js"></script><script src="/js/bootstrap.min.js"></script><script src="/js/main.js"></script><script src="/js/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script>(function (i, s, o, g, r, a, m) {
    i['GoogleAnalyticsObject'] = r;
    i[r] = i[r] || function () {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date();
    a = s.createElement(o),
            m = s.getElementsByTagName(o)[0];
    a.async = 1;
    a.src = g;
    m.parentNode.insertBefore(a, m)
})(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
ga('create', 'UA-91266041-1', 'auto');
ga('send', 'pageview');</script></body></html>